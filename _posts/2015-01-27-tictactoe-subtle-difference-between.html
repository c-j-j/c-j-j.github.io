---
layout: post
title: 'TicTacToe: A subtle difference between Minimax and Negamax'
date: '2015-01-27T01:55:00.002-08:00'
author: Chris Jordan
tags: 
modified_time: '2015-01-27T01:55:42.790-08:00'
blogger_id: tag:blogger.com,1999:blog-7991013704143924726.post-6637876196212385820
blogger_orig_url: http://chrisjordan8l.blogspot.com/2015/01/tictactoe-subtle-difference-between.html
---

TL/DR - The heuristic score returned from Minimax is based on the perspective of maximising player. The heuristic score from Negamax is based on the current player that is passed to the Negamax algorithm. &nbsp;<br /><br />Yesterday afternoon I decided to change the core algorithm of my TicTacToe program from using&nbsp;<a href="http://en.wikipedia.org/wiki/Minimax">Minimax</a>&nbsp;to use <a href="http://en.wikipedia.org/wiki/Negamax">Negamax</a>. The algorithms look identical, Negamax is a similar but more concise algorithm that is ideal of a two-person turn taking game like TicTacToe.<br /><br />My Minimax algorithm worked just fine, and I had several unit tests ensuring that the computer player will pick the right moves, i.e.<br />1. Win when possible<br />2. Block when it has to<br />3. Fork if possible.<br />4. Start in the centre.<br /><div><br /></div>I also had an integration test that checked two computer players always draw.<br /><br />However, my initial attempt at Negamax just wouldn't work and it consistently picked the wrong moves. This kind of recursive algorithm is difficult to break down into smaller parts without obfuscating the code just to make it easier to write tests for. My only option to debug this with print line statements and trying to dissect the code at various stages.<br /><br />After several hours of this, I was getting nowhere and gave up for the day. I decided to read the Negamax algorithm again, and there is a difference in how Minimax and Negamax work.<br /><br />With Minimax, you calculate the heuristic value of the node based on the maximizing player. In other words, when the game is over you calculate the score based on the computer player (lets call this player A) you are trying to calculate the next move for. If player A wins, return&nbsp;+10, if player A loses, return -10, else return 0. We are only interested in calculating the score based on player's A perspective.<br /><br /><pre style="background-color: #f9f9f9; border: 1px solid rgb(221, 221, 221); font-family: monospace, Courier; font-size: 14px; line-height: 1.3em; padding: 1em;"><b>function</b> minimax(node, depth, maximizingPlayer)<br />    <b>if</b> depth = 0 <b>or</b> node is a terminal node<br />        <b>return</b> the heuristic value of node <span style="color: red;">//from perspective of player A</span><br />    <b>if</b> maximizingPlayer<br />        bestValue := -∞<br />        <b>for each</b> child of node<br />            val := minimax(child, depth - 1, FALSE)<br />            bestValue := max(bestValue, val)<br />        <b>return</b> bestValue<br />    <b>else</b><br />        bestValue := +∞<br />        <b>for each</b> child of node<br />            val := minimax(child, depth - 1, TRUE)<br />            bestValue := min(bestValue, val)<br />        <b>return</b> bestValue<br /></pre><div><br /></div><div>My initial Negamax algorithm did the same thing, it calculated the score only based on Player A's perspective. However on Wikipedia the following is stated;</div><div><br /></div><div><i>"<span style="background-color: white; color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;">The negamax node's return value is a heuristic score from the point of view of the node's current player"</span></i></div><div><i><span style="background-color: white; color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;"><br /></span></i></div><div><span style="background-color: white; color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;">This was the issue, I&nbsp;</span><span style="color: #252525; font-family: sans-serif;"><span style="font-size: 14px; line-height: 22px;">should've read it thoroughly the first time round without making an assumption about the scoring mechanism. I don't think the Wikipedia pseudocode makes this very clear, so here is the algorithm which I have now followed which works.&nbsp;</span></span></div><div><span style="color: #252525; font-family: sans-serif;"><span style="font-size: 14px; line-height: 22px;"><br /></span></span></div><pre style="background-color: #f9f9f9; border: 1px solid rgb(221, 221, 221); font-family: monospace, Courier; font-size: 14px; line-height: 1.3em; padding: 1em;"><b>function</b> negamax(node, current_player)<br />    <b>if</b> node is a terminal node</pre><pre style="background-color: #f9f9f9; border: 1px solid rgb(221, 221, 221); font-family: monospace, Courier; font-size: 14px; line-height: 1.3em; padding: 1em;"><span style="color: red;"><span style="line-height: 1.3em;">        </span><b style="line-height: 1.3em;">return</b><span style="line-height: 1.3em;"> the heuristic value of node based on current player</span></span></pre><pre style="background-color: #f9f9f9; border: 1px solid rgb(221, 221, 221); font-family: monospace, Courier; font-size: 14px; line-height: 1.3em; padding: 1em;">    bestValue := -∞<br />    <b>foreach</b> child of node<br />        val := -negamax(child, other_player)<br />        bestValue := max( bestValue, val )<br />    <b>return</b> bestValue<br /></pre><div><span style="color: #252525; font-family: sans-serif;"><span style="font-size: 14px; line-height: 22px;">&nbsp;</span></span></div><div><span style="color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;">Therefore if you&nbsp;are calculating the score for Player A, and the current player being called in Negamax is Player B, you calculate the score based on Player B's perspective.&nbsp;</span></div><div><span style="color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;"><br /></span></div><div><span style="color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;"><br /></span></div>